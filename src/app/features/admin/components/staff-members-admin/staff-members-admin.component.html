<section class="staff-management">
  <h2 class="section-title">
    <div class="title-left">
      <mat-icon>badge</mat-icon>
      <span>Gestione Staff</span>
    </div>

    <button
      mat-mini-fab
      color="primary"
      (click)="openCreate()"
      matTooltip="Nuovo membro">
      <mat-icon>person_add</mat-icon>
    </button>
  </h2>

  <form [formGroup]="filterForm" class="filters">
    <mat-form-field appearance="outline">
      <mat-label>Nome</mat-label>
      <input matInput formControlName="name" placeholder="Filtra per nome" />
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Ruolo</mat-label>
      <mat-select formControlName="role">
        <mat-option value="">Tutti</mat-option>
        <mat-option value="tatuatore">Tatuatore</mat-option>
        <mat-option value="piercer">Piercer</mat-option>
        <mat-option value="guest">Guest</mat-option>
        <mat-option value="altro">Altro</mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Stato</mat-label>
      <mat-select formControlName="status">
        <mat-option value="">Tutti</mat-option>
        <mat-option value="active">Solo attivi</mat-option>
        <mat-option value="inactive">Solo non attivi</mat-option>
      </mat-select>
    </mat-form-field>
  </form>

  <div class="staff-cards">
    <mat-card *ngFor="let member of filteredStaff" class="staff-card" [class.inactive]="!member.isActive">
      <div class="staff-info">
        <img [src]="member.photoUrl || '/assets/avatar-placeholder.png'" alt="avatar" />
        <div class="staff-text">
          <h3>{{ member.name }}</h3>
          <p class="role">{{ member.role | titlecase }}</p>

          <p class="bio" *ngIf="member.bio">
            {{ member.bio }}
          </p>

          <span class="status-chip" [class.active]="member.isActive" [class.inactive]="!member.isActive">
            {{ member.isActive ? 'Attivo' : 'Non attivo' }}
          </span>
        </div>
      </div>

      <div class="staff-actions">
        <button mat-icon-button matTooltip="Dettaglio (orari e calendario)" (click)="openDetail(member)">
          <mat-icon>event</mat-icon>
        </button>
        <button mat-icon-button matTooltip="Modifica" (click)="openEdit(member)">
          <mat-icon>edit</mat-icon>
        </button>
        <button mat-icon-button color="warn" matTooltip="Revoca staff" (click)="revoke(member.id!)">
          <mat-icon>person_remove</mat-icon>
        </button>
      </div>
    </mat-card>

    <p class="empty" *ngIf="filteredStaff.length === 0">
      Nessun membro trovato con i filtri correnti.
    </p>
  </div>
</section>

