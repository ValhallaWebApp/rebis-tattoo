<section class="services-management">
  <!-- HEADER -->
  <h2 class="section-title">
    <div class="title-left">
      <mat-icon>design_services</mat-icon>
      <span>Servizi Offerti</span>
    </div>

    <button
      mat-mini-fab
      color="primary"
      (click)="openCreate()"
      matTooltip="Nuovo servizio"
    >
      <mat-icon>add</mat-icon>
    </button>
  </h2>

  <!-- CONTENUTO PRINCIPALE -->
  <div class="drawer-content">
    <!-- FILTRI -->
    <form [formGroup]="filterForm" class="filters">
      <mat-form-field>
        <mat-label>Nome</mat-label>
        <input
          matInput
          formControlName="name"
          placeholder="Filtra per nome"
        />
      </mat-form-field>

      <mat-form-field>
        <mat-label>Categoria</mat-label>
        <mat-select formControlName="categoria">
          <mat-option value="">Tutte</mat-option>
          <mat-option value="tatuaggio">Tatuaggio</mat-option>
          <mat-option value="piercing">Piercing</mat-option>
          <mat-option value="laser">Laser</mat-option>
          <mat-option value="consulenza">Consulenza</mat-option>
          <mat-option value="altro">Altro</mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field>
        <mat-label>Visibilita'</mat-label>
        <mat-select formControlName="visibile">
          <mat-option value="">Tutti</mat-option>
          <mat-option value="true">Solo visibili</mat-option>
          <mat-option value="false">Solo nascosti</mat-option>
        </mat-select>
      </mat-form-field>
    </form>

    <!-- LISTA SERVIZI -->
    <div class="service-cards">
      <mat-card
        *ngFor="let service of filteredServices"
        class="service-card"
        [class.inactive]="!service.visibile"
      >
        <div class="service-info">
          <div class="icon-pill">
            <img *ngIf="service.icon" [src]="service.icon" alt="" />
            <mat-icon *ngIf="!service.icon">design_services</mat-icon>
          </div>

          <div class="service-text">
            <h3>{{ service.name }}</h3>
            <p class="category">{{ service.categoria }}</p>

            <p class="description">
              {{ service.description || 'Nessuna descrizione' }}
            </p>

            <div class="meta">
              <span class="price">
                {{ service.prezzoDaConcordare ? 'Prezzo su richiesta' : ('â‚¬' + service.prezzo) }}
              </span>
              <span class="duration">
                {{ service.durataDaConcordare ? 'Durata su richiesta' : (service.durata + ' min') }}
              </span>
            </div>

            <span
              class="status-chip"
              [class.active]="service.visibile"
              [class.inactive]="!service.visibile"
            >
              {{ service.visibile ? 'Visibile' : 'Non visibile' }}
            </span>
          </div>
        </div>

        <div class="service-actions">
          <button
            mat-icon-button
            matTooltip="Modifica servizio"
            (click)="openEdit(service)"
          >
            <mat-icon>edit</mat-icon>
          </button>

          <button
            mat-icon-button
            color="warn"
            matTooltip="Elimina"
            (click)="deleteService(service.id)"
          >
            <mat-icon>delete</mat-icon>
          </button>
        </div>
      </mat-card>

      <p class="empty" *ngIf="filteredServices.length === 0">
        Nessun servizio trovato con i filtri correnti.
      </p>
    </div>
  </div>
</section>
