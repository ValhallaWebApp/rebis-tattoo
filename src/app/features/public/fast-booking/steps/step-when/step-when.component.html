<section class="step">
  <header class="head">
    <h2>Quando vuoi venire?</h2>
    <p class="sub">
      Seleziona un giorno e poi un orario disponibile per la consulenza.
    </p>
  </header>

  <div class="card">
    <div class="label">Giorno</div>

    <div class="days">
      @for (d of days(); track d.value) {
        <button
          mat-button
          class="day"
          [class.active]="selectedDate() === d.value"
          (click)="pickDate(d.value)">
          {{ d.label }}
        </button>
      }
    </div>

    <div class="divider"></div>

    <div class="label">Orari disponibili</div>

    @if (loading()) {
      <div class="loading">
        <mat-progress-spinner diameter="24" mode="indeterminate"></mat-progress-spinner>
        <span>Carico disponibilità…</span>
      </div>
    } @else {
      @if (error() && selectedDate()) {
        <div class="error">{{ error() }}</div>
      }

      @if (slots().length === 0 && selectedDate()) {
        <div class="empty">Nessuno slot disponibile per questo giorno.</div>
      }

      <div class="times">
        @for (s of slots(); track s.time) {
          <button
            mat-stroked-button
            class="time"
            [class.active]="draft().time === s.time"
            (click)="pickTime(s.time)">
            <mat-icon class="ico">schedule</mat-icon>
            {{ s.time }}
          </button>
        }
      </div>
    }
  </div>
</section>
