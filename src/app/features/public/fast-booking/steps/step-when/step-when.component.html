<section class="step">
  <header class="head">
    <h1 class="h1">QUANDO</h1>
    <p class="p">Seleziona un giorno e poi un orario disponibile per la consulenza.</p>
  </header>

  <mat-card class="card">
    <div class="label">Giorno</div>

    <div class="days">
      @for (d of days(); track d.value) {
        <button
          mat-stroked-button
          class="day"
          [class.active]="selectedDate() === d.value"
          (click)="pickDate(d.value)">
          {{ d.label }}
        </button>
      }
    </div>

    <mat-divider></mat-divider>

    <div class="label">Orari disponibili</div>

    @if (loading()) {
      <div class="loading">
        <mat-progress-spinner diameter="22" mode="indeterminate"></mat-progress-spinner>
        <span>Carico disponibilità…</span>
      </div>
    } @else {
      @if (error() && selectedDate()) {
        <div class="error">
          <mat-icon>error</mat-icon>
          <span>{{ error() }}</span>
        </div>
      }

      @if (slots().length === 0 && selectedDate()) {
        <div class="empty">
          Nessuno slot disponibile per questo giorno.
        </div>
      }

      <div class="times">
        @for (s of slots(); track s.time) {
          <button
            mat-stroked-button
            class="time"
            [class.active]="draft().time === s.time"
            (click)="pickTime(s.time)">
            <mat-icon class="ico">schedule</mat-icon>
            {{ s.time }}
          </button>
        }
      </div>
    }
  </mat-card>
</section>
