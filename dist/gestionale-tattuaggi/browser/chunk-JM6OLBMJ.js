import{G as h,J as I,K as g,M as d,N as f,O as y,P as w,Q as i,R as O,S as j,U as x}from"./chunk-RWUD3VOV.js";import{a as s,b as p,e as b,h as c,ja as l,oa as m}from"./chunk-JF75SBGN.js";var $=class v{constructor(t){this.db=t}path="invoices";getInvoices(){return new c(t=>{let e=i(this.db,this.path);d(e,n=>{let a=n.val(),o=a?Object.entries(a).map(([r,u])=>s({id:r},u)):[];t.next(o)})})}getInvoicesByClient(t){return new c(e=>{let n=w(i(this.db,this.path),f("clientId"),I(t));d(n,a=>{let o=a.val(),r=o?Object.entries(o).map(([u,A])=>s({id:u},A)):[];e.next(r)})})}getInvoiceById(t){return b(this,null,function*(){let e=yield g(i(this.db,`${this.path}/${t}`));return e.exists()?s({id:t},e.val()):null})}addInvoice(t){let e=y(i(this.db,this.path)),n=new Date().toISOString();return j(e,p(s({},t),{bookingId:e.key,createdAt:n,updatedAt:n}))}updateInvoice(t,e){return x(i(this.db,`${this.path}/${t}`),p(s({},e),{updatedAt:new Date().toISOString()}))}deleteInvoice(t){return O(i(this.db,`${this.path}/${t}`))}getTotalRevenue(){return new c(t=>{let e=i(this.db,this.path);d(e,n=>{let a=n.val(),o=0;a&&Object.values(a).forEach(r=>{r.status==="paid"&&typeof r.amount=="number"&&(o+=r.amount)}),t.next(o)})})}static \u0275fac=function(e){return new(e||v)(m(h))};static \u0275prov=l({token:v,factory:v.\u0275fac,providedIn:"root"})};export{$ as a};
