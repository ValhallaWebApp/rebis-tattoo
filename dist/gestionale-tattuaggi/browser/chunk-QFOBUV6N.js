import{a as ut}from"./chunk-WHH6AMQE.js";import{a as gt}from"./chunk-Q5BBUC7E.js";import{Fb as st,Nb as lt,Ob as ct,Pb as pt,Qb as dt,Z as et,cc as mt,eb as rt,ec as ft,jb as ot,lb as at,va as it,xa as nt}from"./chunk-VVGPL6SB.js";import"./chunk-CARY4E7O.js";import{f as J,h as K,i as X,l as tt}from"./chunk-3PBLYRJ4.js";import{$b as Q,Ba as v,Ia as s,Ja as r,Ka as F,Oa as y,Ra as x,Ta as d,_ as V,ac as H,bb as B,ca as a,cb as c,db as S,eb as P,hb as Z,i as O,ib as $,ic as G,jb as W,lb as R,lc as Y,m as z,nb as D,qb as N,sb as U,ua as _,v as f,vb as q,w as u,ya as b,za as m}from"./chunk-I2SBXG73.js";import"./chunk-VPSPPOSA.js";import"./chunk-L4TIKYZG.js";import{$ as L,X as E}from"./chunk-Y3XNR5LB.js";import"./chunk-ACKELEN3.js";var ht=n=>["/progetto",n];function _t(n,e){if(n&1&&(s(0,"mat-option",15),c(1),r()),n&2){let t=e.$implicit;m("value",t.id),a(),P(" ",t.name," ")}}function yt(n,e){if(n&1){let t=y();s(0,"button",19),x("click",function(){let o=f(t).$implicit,l=d(2);return u(l.setStyle(o))}),c(1),r()}if(n&2){let t=e.$implicit,i=d(2);v("active",i.isStyleActive(t)),b("aria-pressed",i.isStyleActive(t)),a(),P(" ",t," ")}}function bt(n,e){if(n&1){let t=y();s(0,"div",16)(1,"div",17),c(2,"Stile"),r(),s(3,"div",18)(4,"button",19),x("click",function(){f(t);let o=d();return u(o.setStyle("all"))}),c(5," Tutti "),r(),_(6,yt,2,4,"button",20),r()()}if(n&2){let t=d();a(4),v("active",t.isStyleActive("all")),b("aria-pressed",t.isStyleActive("all")),a(2),m("ngForOf",t.styles)}}function vt(n,e){if(n&1){let t=y();s(0,"button",19),x("click",function(){let o=f(t).$implicit,l=d(2);return u(l.setSubject(o))}),c(1),r()}if(n&2){let t=e.$implicit,i=d(2);v("active",i.isSubjectActive(t)),b("aria-pressed",i.isSubjectActive(t)),a(),P(" ",t," ")}}function Pt(n,e){if(n&1){let t=y();s(0,"div",16)(1,"div",17),c(2,"Soggetto"),r(),s(3,"div",18)(4,"button",19),x("click",function(){f(t);let o=d();return u(o.setSubject("all"))}),c(5," Tutti "),r(),_(6,vt,2,4,"button",20),r()()}if(n&2){let t=d();a(4),v("active",t.isSubjectActive("all")),b("aria-pressed",t.isSubjectActive("all")),a(2),m("ngForOf",t.subjects)}}function Ct(n,e){if(n&1){let t=y();s(0,"button",19),x("click",function(){let o=f(t).$implicit,l=d(2);return u(l.setZone(o))}),c(1),r()}if(n&2){let t=e.$implicit,i=d(2);v("active",i.isZoneActive(t)),b("aria-pressed",i.isZoneActive(t)),a(),P(" ",t," ")}}function Ot(n,e){if(n&1){let t=y();s(0,"div",16)(1,"div",17),c(2,"Zona"),r(),s(3,"div",18)(4,"button",19),x("click",function(){f(t);let o=d();return u(o.setZone("all"))}),c(5," Tutti "),r(),_(6,Ct,2,4,"button",20),r()()}if(n&2){let t=d();a(4),v("active",t.isZoneActive("all")),b("aria-pressed",t.isZoneActive("all")),a(2),m("ngForOf",t.zones)}}function St(n,e){if(n&1&&(s(0,"div",36)(1,"mat-icon"),c(2,"collections"),r(),c(3),r()),n&2){let t=d().$implicit,i=d(2);a(3),P(" ",i.imagesCount(t)," ")}}function jt(n,e){if(n&1){let t=y();s(0,"mat-card",23)(1,"a",24)(2,"div",25)(3,"img",26),x("error",function(o){f(t);let l=d(2);return u(l.onImgError(o))}),r(),F(4,"div",27),_(5,St,4,1,"div",28),r(),s(6,"div",29)(7,"h3",30),c(8),r(),s(9,"p",31)(10,"span",32),c(11),r(),s(12,"span",33),c(13,"-"),r(),s(14,"span",34),c(15),N(16,"date"),r()(),s(17,"span",35),c(18,"Dettagli ->"),r()()()()}if(n&2){let t=e.$implicit,i=d(2);a(),m("routerLink",t.id?D(10,ht,t.id):null),a(2),m("src",i.coverOf(t),V)("alt",t.title),a(2),m("ngIf",i.imagesCount(t)>1),a(3),S(i.titleOf(t)),a(3),S(i.artistNameById(t.artistId)),a(4),P(" ",i.createdAtOf(t)?U(16,7,i.createdAtOf(t),"dd/MM/yyyy"):"-"," ")}}function wt(n,e){if(n&1&&(s(0,"section",21),_(1,jt,19,12,"mat-card",22),r()),n&2){let t=d();a(),m("ngForOf",t.filteredProjects)("ngForTrackBy",t.trackById)}}function Mt(n,e){n&1&&(s(0,"p",37),c(1,"Nessun progetto trovato."),r())}var xt=class n{route=O(J);router=O(K);staffService=O(ft);projectsService=O(ut);lang=O(gt);sub;lastRouteArtistId=null;projects=[];filteredProjects=[];artists=[];selectedArtistId="all";selectedStyle="all";selectedSubject="all";selectedZone="all";onlyWithImages=!1;styles=[];subjects=[];zones=[];fallbackCover=`data:image/svg+xml;utf8,${encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="800" viewBox="0 0 1200 800"><defs><linearGradient id="g" x1="0" x2="1" y1="0" y2="1"><stop offset="0" stop-color="#151515"/><stop offset="1" stop-color="#2a2a2a"/></linearGradient></defs><rect width="1200" height="800" fill="url(#g)"/><rect x="80" y="80" width="1040" height="640" fill="none" stroke="#3a3a3a" stroke-width="6" rx="28"/><path d="M360 520l140-160 120 120 180-220 220 260" fill="none" stroke="#8a8a8a" stroke-width="14" stroke-linecap="round" stroke-linejoin="round"/><circle cx="460" cy="320" r="46" fill="#8a8a8a"/><text x="600" y="680" fill="#9a9a9a" font-size="32" text-anchor="middle" font-family="Arial, sans-serif">No photo</text></svg>')}`;ngOnInit(){let e=this.staffService.getAllStaff().pipe(E(l=>(l??[]).filter(p=>p?.isActive!==!1))),t=this.projectsService.getProjects().pipe(E(l=>(l??[]).filter(p=>p.isPublic!==!1&&String(p.status??"").trim()==="completed"))),i=this.route.paramMap.pipe(E(l=>l.get("artistId"))),o=this.route.queryParamMap;this.sub=L([t,e,i,o]).subscribe(([l,p,h,C])=>{this.projects=l??[],this.artists=p??[];let j=h??null;j!==this.lastRouteArtistId&&(this.lastRouteArtistId=j,this.selectedArtistId=j??"all");let w=C.get("artistId"),M=C.get("style"),T=C.get("subject"),I=C.get("zone"),k=C.get("images");w&&w!==this.selectedArtistId&&(this.selectedArtistId=w),M&&M!==this.selectedStyle&&(this.selectedStyle=M),T&&T!==this.selectedSubject&&(this.selectedSubject=T),I&&I!==this.selectedZone&&(this.selectedZone=I),k&&k!==(this.onlyWithImages?"1":"0")&&(this.onlyWithImages=k==="1"),this.styles=Array.from(new Set(this.projects.flatMap(g=>this.stylesOf(g)).filter(Boolean))).sort((g,A)=>g.localeCompare(A)),this.subjects=Array.from(new Set(this.projects.flatMap(g=>this.subjectsOf(g)).filter(Boolean))).sort((g,A)=>g.localeCompare(A)),this.zones=Array.from(new Set(this.projects.flatMap(g=>this.zonesOf(g)).filter(Boolean))).sort((g,A)=>g.localeCompare(A)),this.applyFilters()})}ngOnDestroy(){this.sub?.unsubscribe()}applyFilters(){let e=this.selectedArtistId,t=this.selectedStyle,i=this.selectedSubject,o=this.selectedZone,l=this.onlyWithImages;this.filteredProjects=(this.projects??[]).filter(p=>{let h=this.artistIdsOf(p),C=e==="all"||h.includes(String(e)),j=t==="all"||this.matchTag(t,this.stylesOf(p)),w=i==="all"||this.matchTag(i,this.subjectsOf(p)),M=o==="all"||this.matchTag(o,this.zonesOf(p)),I=p.isPublic!==!1,k=this.imageUrlsOf(p).length>0;return C&&j&&w&&M&&I&&(!l||k)}),this.filteredProjects.sort((p,h)=>this.createdAtOf(h).localeCompare(this.createdAtOf(p)))}resetFilters(){this.selectedArtistId="all",this.selectedStyle="all",this.selectedSubject="all",this.selectedZone="all",this.onlyWithImages=!1,this.applyFilters(),this.router.navigate(["/progetti"],{queryParams:{}})}onArtistChange(){this.applyFilters(),this.syncToQueryParams()}setStyle(e){this.selectedStyle=e,this.applyFilters(),this.syncToQueryParams()}setSubject(e){this.selectedSubject=e,this.applyFilters(),this.syncToQueryParams()}setZone(e){this.selectedZone=e,this.applyFilters(),this.syncToQueryParams()}toggleOnlyImages(){this.onlyWithImages=!this.onlyWithImages,this.applyFilters(),this.syncToQueryParams()}isStyleActive(e){return this.selectedStyle===e}isSubjectActive(e){return this.selectedSubject===e}isZoneActive(e){return this.selectedZone===e}artistNameById(e){return this.artists.find(t=>String(t.id??"")===e)?.name??"\u2014"}titleOf(e){return String(e.title??e.name??"").trim()||"Progetto"}createdAtOf(e){return String(e.createdAt??e.createAt??e.dataProgetto??"").trim()}styleOf(e){return String(e.style??e.genere??"").trim()}subjectOf(e){return String(e.subject??"").trim()}zoneOf(e){return String(e.zone??e.bodyPart??"").trim()}artistIdsOf(e){let t=String(e.artistId??"").trim(),o=(Array.isArray(e.artistIds)?e.artistIds:[]).map(p=>String(p??"").trim()).filter(Boolean),l=[t,...o].filter(Boolean);return l.length?Array.from(new Set(l)):[]}stylesOf(e){return this.splitTags(this.styleOf(e))}subjectsOf(e){return this.splitTags(this.subjectOf(e))}zonesOf(e){let t=this.zoneOf(e),i=String(e.placement??"").trim();return this.splitTags([t,i].filter(Boolean).join(", "))}splitTags(e){if(!e)return[];let t=e.split(/[\/|,;]/g).map(i=>i.trim()).filter(Boolean);return t.length?Array.from(new Set(t)):[]}matchTag(e,t){let i=String(e??"").trim().toLowerCase();return i?t.some(o=>String(o??"").trim().toLowerCase()===i):!0}syncToQueryParams(){let e={artistId:this.selectedArtistId!=="all"?this.selectedArtistId:null,style:this.selectedStyle!=="all"?this.selectedStyle:null,subject:this.selectedSubject!=="all"?this.selectedSubject:null,zone:this.selectedZone!=="all"?this.selectedZone:null,images:this.onlyWithImages?"1":null};this.router.navigate([],{relativeTo:this.route,queryParams:e,queryParamsHandling:"merge"})}imageUrlsOf(e){let t=Array.isArray(e.finalImages)?e.finalImages.map(h=>String(h?.url??"").trim()).filter(Boolean):[],i=Array.isArray(e.imageUrls)?e.imageUrls:[],o=Array.isArray(e.copertine)?e.copertine:[],l=[...i,...o].map(h=>String(h??"").trim()).filter(Boolean),p=[...t,...l];return p.length?Array.from(new Set(p)):[]}coverOf(e){let i=(Array.isArray(e.finalImages)?e.finalImages:[]).find(l=>l?.isCover)?.url?.trim?.();return i||this.imageUrlsOf(e)[0]||this.fallbackCover}imagesCount(e){return this.imageUrlsOf(e).length}onImgError(e){let t=e.target;t&&t.src!==this.fallbackCover&&(t.src=this.fallbackCover)}trackById=(e,t)=>t.id??`${t.artistId}-${t.clientId}-${t.title}`;static \u0275fac=function(t){return new(t||n)};static \u0275cmp=z({type:n,selectors:[["app-project-list"]],standalone:!0,features:[R],decls:34,vars:14,consts:[["empty",""],[1,"portfolio-page"],[1,"portfolio-header"],[1,"title-row"],[1,"count-badge"],["multi","",1,"portfolio-filter-panel"],[1,"filters"],["appearance","fill"],[3,"valueChange","selectionChange","value"],["value","all"],[3,"value",4,"ngFor","ngForOf"],["class","chip-group",4,"ngIf"],["type","button",1,"chip","toggle",3,"click"],["mat-stroked-button","","type","button",1,"reset-btn",3,"click"],["class","portfolio-grid",4,"ngIf","ngIfElse"],[3,"value"],[1,"chip-group"],[1,"chip-label"],[1,"chip-row"],["type","button",1,"chip",3,"click"],["type","button","class","chip",3,"active","click",4,"ngFor","ngForOf"],[1,"portfolio-grid"],["class","project-card",4,"ngFor","ngForOf","ngForTrackBy"],[1,"project-card"],[1,"card-link",3,"routerLink"],[1,"cover"],["loading","lazy","decoding","async",3,"error","src","alt"],[1,"overlay"],["class","photo-count",4,"ngIf"],[1,"meta"],[1,"title"],[1,"sub"],[1,"artist"],[1,"dot"],[1,"date"],[1,"details"],[1,"photo-count"],[1,"empty"]],template:function(t,i){if(t&1){let o=y();s(0,"section",1)(1,"header",2)(2,"div",3)(3,"h1"),c(4),r(),s(5,"span",4),c(6),r()(),s(7,"p"),c(8),r()(),s(9,"mat-accordion",5)(10,"mat-expansion-panel")(11,"mat-expansion-panel-header")(12,"mat-panel-title"),c(13),r()(),s(14,"div",6)(15,"mat-form-field",7)(16,"mat-label"),c(17,"Artista"),r(),s(18,"mat-select",8),W("valueChange",function(p){return f(o),$(i.selectedArtistId,p)||(i.selectedArtistId=p),u(p)}),x("selectionChange",function(){return f(o),u(i.onArtistChange())}),s(19,"mat-option",9),c(20,"Tutti"),r(),_(21,_t,2,2,"mat-option",10),r()(),_(22,bt,7,4,"div",11)(23,Pt,7,4,"div",11)(24,Ot,7,4,"div",11),s(25,"button",12),x("click",function(){return f(o),u(i.toggleOnlyImages())}),c(26," Solo con immagini "),r(),s(27,"button",13),x("click",function(){return f(o),u(i.resetFilters())}),s(28,"mat-icon"),c(29,"restart_alt"),r(),c(30," Reset "),r()()()(),_(31,wt,2,2,"section",14)(32,Mt,2,0,"ng-template",null,0,q),r()}if(t&2){let o=B(33);a(4),S(i.lang.t("portfolio.title")),a(2),P("",i.filteredProjects.length," progetti"),a(2),S(i.lang.t("portfolio.subtitle")),a(5),S(i.lang.t("portfolio.filtersTitle")),a(5),Z("value",i.selectedArtistId),a(3),m("ngForOf",i.artists),a(),m("ngIf",i.styles.length),a(),m("ngIf",i.subjects.length),a(),m("ngIf",i.zones.length),a(),v("active",i.onlyWithImages),b("aria-pressed",i.onlyWithImages),a(6),m("ngIf",i.filteredProjects.length)("ngIfElse",o)}},dependencies:[Y,Q,H,G,tt,X,mt,it,nt,ot,rt,at,dt,lt,ct,pt,et,st],styles:["[_nghost-%COMP%]{display:block}.portfolio-page[_ngcontent-%COMP%]{padding:18px 16px 28px;display:flex;flex-direction:column;gap:14px;max-width:1280px;margin:0 auto;width:100%}.portfolio-header[_ngcontent-%COMP%]{padding:16px 16px 8px;border-radius:18px;border:1px solid rgba(255,255,255,.08);background:#ffffff08}.portfolio-header[_ngcontent-%COMP%]   .title-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.portfolio-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:22px;font-weight:900;letter-spacing:.3px}.portfolio-header[_ngcontent-%COMP%]   .count-badge[_ngcontent-%COMP%]{padding:4px 10px;border-radius:999px;border:1px solid rgba(255,255,255,.14);background:#00000059;font-weight:900;font-size:12px;opacity:.95}.portfolio-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:6px 0 0;opacity:.75;font-size:13px}.portfolio-filter-panel[_ngcontent-%COMP%]{border-radius:18px;overflow:hidden}.portfolio-filter-panel[_ngcontent-%COMP%]     .mat-expansion-panel{border-radius:18px!important;background:#ffffff08;border:1px solid rgba(255,255,255,.08)}.portfolio-filter-panel[_ngcontent-%COMP%]     .mat-expansion-panel-header{padding:0 16px}.filters[_ngcontent-%COMP%]{padding:14px 16px 18px;display:grid;grid-template-columns:repeat(2,minmax(160px,1fr));gap:12px}.filters[_ngcontent-%COMP%]   .reset-btn[_ngcontent-%COMP%]{align-self:end;height:56px;border-radius:14px}.filters[_ngcontent-%COMP%]   .reset-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:6px;opacity:.85}@media (max-width: 1100px){.filters[_ngcontent-%COMP%]{grid-template-columns:repeat(2,minmax(160px,1fr))}}@media (max-width: 640px){.filters[_ngcontent-%COMP%]{grid-template-columns:1fr}}.chip-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;padding:6px 0 4px}.chip-label[_ngcontent-%COMP%]{font-size:12px;opacity:.75;font-weight:700}.chip-row[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px}.chip[_ngcontent-%COMP%]{border-radius:999px;padding:6px 12px;border:1px solid rgba(255,255,255,.12);background:#00000040;color:inherit;font-size:12px;font-weight:800;letter-spacing:.2px;cursor:pointer;transition:border-color .18s ease,background .18s ease,transform .18s ease}.chip[_ngcontent-%COMP%]:hover{transform:translateY(-1px);border-color:#fff3}.chip.active[_ngcontent-%COMP%]{background:#ffffff1f;border-color:#ffffff4d}.chip.toggle[_ngcontent-%COMP%]{align-self:start;height:36px;justify-self:start}.portfolio-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,minmax(220px,1fr));gap:14px}@media (max-width: 1200px){.portfolio-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(3,minmax(220px,1fr))}}@media (max-width: 900px){.portfolio-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,minmax(220px,1fr))}}@media (max-width: 560px){.portfolio-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.project-card[_ngcontent-%COMP%]{border-radius:18px;overflow:hidden;border:1px solid rgba(255,255,255,.08);background:#00000038;transition:transform .18s ease,box-shadow .18s ease,border-color .18s ease}.project-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);border-color:#ffffff29;box-shadow:0 14px 35px #00000059}.project-card[_ngcontent-%COMP%]     .mat-mdc-card-content{padding:0!important}.card-link[_ngcontent-%COMP%]{display:grid;grid-template-rows:180px auto;text-decoration:none;color:inherit}.card-link[_ngcontent-%COMP%]:focus-visible{outline:2px solid rgba(255,255,255,.45);outline-offset:3px;border-radius:18px}.cover[_ngcontent-%COMP%]{position:relative;height:180px;background:#ffffff0a}.cover[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;display:block;transform:scale(1.02);transition:transform .25s ease}.cover[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:linear-gradient(180deg,#0000001a,#0000008c);opacity:.95;transition:opacity .2s ease}.project-card[_ngcontent-%COMP%]:hover   .cover[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{transform:scale(1.08)}.project-card[_ngcontent-%COMP%]:hover   .cover[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{opacity:1}.badge[_ngcontent-%COMP%]{position:absolute;left:12px;top:12px;padding:6px 10px;font-size:12px;border-radius:999px;border:1px solid rgba(255,255,255,.16);background:#00000061;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);max-width:calc(100% - 24px);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.pill[_ngcontent-%COMP%]{position:absolute;right:12px;top:12px;padding:6px 10px;font-size:12px;border-radius:999px;border:1px solid rgba(255,255,255,.16);background:#00000061;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);opacity:.95}.pill.is-hidden[_ngcontent-%COMP%]{border-color:#f43f5e59;background:#f43f5e1f}.photo-count[_ngcontent-%COMP%]{position:absolute;right:12px;bottom:12px;display:inline-flex;align-items:center;gap:6px;padding:6px 10px;font-size:12px;border-radius:999px;border:1px solid rgba(255,255,255,.16);background:#0000006b;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px)}.photo-count[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{width:18px;height:18px;font-size:18px;opacity:.9}.meta[_ngcontent-%COMP%]{padding:14px 14px 16px;display:flex;flex-direction:column;gap:8px}.title[_ngcontent-%COMP%]{margin:0;font-size:15px;font-weight:900;line-height:1.25;overflow:hidden;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}.sub[_ngcontent-%COMP%]{margin:0;display:flex;align-items:center;gap:8px;font-size:12px;opacity:.78}.sub[_ngcontent-%COMP%]   .dot[_ngcontent-%COMP%]{opacity:.55}.sub[_ngcontent-%COMP%]   .artist[_ngcontent-%COMP%]{font-weight:700;opacity:.92}.details[_ngcontent-%COMP%]{margin-top:4px;font-size:12px;font-weight:800;letter-spacing:.2px;opacity:.9}.empty[_ngcontent-%COMP%]{margin:10px 0 0;padding:22px 16px;border-radius:18px;border:1px dashed rgba(255,255,255,.14);background:#ffffff05;opacity:.85}"]})};export{xt as ProjectListComponent};
