import{G as S,J as p,K as w,M as o,N as g,O as y,P as m,Q as r,R as f,S as A,U as j}from"./chunk-RWUD3VOV.js";import{Ra as v}from"./chunk-6RZNEBAJ.js";import{a as l,b as u,e as i,h as n,ja as b,oa as h}from"./chunk-JF75SBGN.js";var M=class c{constructor(e,t){this.db=e;this.snackbar=t}path="sessions";getAll(){let e=r(this.db,this.path);return new n(t=>o(e,s=>{let a=s.exists()?Object.values(s.val()):[];t.next(a)},{onlyOnce:!0}))}showMessage(e,t=!1){this.snackbar.open(e,"Chiudi",{duration:3e3,panelClass:t?["mat-warn"]:["mat-primary"]})}create(e){return i(this,null,function*(){try{let t=y(r(this.db,this.path)),s=new Date().toISOString();yield A(t,u(l({},e),{id:t.key,createdAt:s,updatedAt:s,status:e.status??"planned"})),this.showMessage("Seduta creata con successo")}catch(t){throw console.error("Errore creazione seduta:",t),this.showMessage("Errore durante la creazione della seduta",!0),t}})}update(e,t){return i(this,null,function*(){try{yield j(r(this.db,`${this.path}/${e}`),u(l({},t),{updatedAt:new Date().toISOString()})),this.showMessage("Seduta aggiornata con successo")}catch(s){throw console.error("Errore aggiornamento seduta:",s),this.showMessage("Errore durante l'aggiornamento della seduta",!0),s}})}delete(e){return i(this,null,function*(){try{yield f(r(this.db,`${this.path}/${e}`)),this.showMessage("Seduta eliminata con successo")}catch(t){throw console.error("Errore eliminazione seduta:",t),this.showMessage("Errore durante l'eliminazione della seduta",!0),t}})}getSessionsByArtist(e){let t=m(r(this.db,this.path),g("idArtist"),p(e));return new n(s=>o(t,a=>{let d=a.val()?Object.values(a.val()):[];s.next(d)}))}getSessionsByProject(e){let t=m(r(this.db,this.path),g("projectId"),p(e));return new n(s=>o(t,a=>{let d=a.val()?Object.values(a.val()):[];s.next(d)}))}getSessionById(e){return i(this,null,function*(){let t=yield w(r(this.db,`${this.path}/${e}`));return t.exists()?t.val():null})}static \u0275fac=function(t){return new(t||c)(h(S),h(v))};static \u0275prov=b({token:c,factory:c.\u0275fac,providedIn:"root"})};export{M as a};
