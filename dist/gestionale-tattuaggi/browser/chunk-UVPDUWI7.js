import{a as ot}from"./chunk-EYSGIS5G.js";import{a as Mt}from"./chunk-2UXAJNC3.js";import{j as it,z as nt}from"./chunk-GHRCGBKI.js";import{Ba as _e,K as pt,O as q,P as k,Qa as ve,R as K,Sa as Ce,Ta as ut,Ua as _t,V as ie,Va as vt,W as ne,Wa as Ct,X as oe,Ya as xe,ca as re,d as Kt,db as xt,e as Xt,ea as ae,eb as ht,fb as he,gb as et,h as Nt,ha as le,hb as Me,i as R,ia as me,ib as be,j as P,ja as ce,jb as we,k as T,kb as I,l as D,la as se,ma as pe,na as de,p as $,pa as G,qa as ge,r as te,ra as X,s as N,sa as H,ta as U,ua as j,v as A,va as tt,wa as gt,x as V,xa as fe,ya as ue,z,za as ft}from"./chunk-KFLFF4GH.js";import{Bb as p,Bd as dt,C as Ut,Ca as _,Da as v,Ed as Vt,Gb as c,Ib as st,Pb as i,Qb as e,Rb as g,Sb as Tt,Tb as Dt,Vb as h,Yb as f,_b as s,a as E,b as W,ca as jt,cc as Lt,dc as $t,dd as Qt,e as Gt,ec as qt,ed as F,fb as L,fd as B,gd as Yt,h as Ht,hc as Q,hd as Zt,jb as l,jc as o,ka as mt,kb as M,kc as u,kd as Jt,lc as C,mc as Z,nd as J,pa as x,pd as w,sc as S,ta as O,tc as rt,ua as ct,wc as b,xc as Wt,xd as ee,yc as y,yd as At}from"./chunk-GNSFZVKV.js";function Ie(a,n){if(a&1){let t=h();i(0,"input",22),f("change",function(m){_(t);let d=s();return v(d.onAvatarSelected(m))}),e()}}function Ee(a,n){if(a&1){let t=h();i(0,"button",23),f("click",function(){_(t);let m=s();return v(m.toggleEdit())}),o(1,"MODIFICA"),e()}}function Fe(a,n){if(a&1){let t=h();i(0,"button",23),f("click",function(){_(t);let m=s();return v(m.saveProfile())}),o(1,"SALVA"),e()}}function Be(a,n){if(a&1){let t=h();i(0,"button",24),f("click",function(){_(t);let m=s();return v(m.toggleEdit())}),o(1,"ANNULLA"),e()}}function Re(a,n){if(a&1&&(i(0,"mat-card",25)(1,"h3"),o(2,"Prossima seduta"),e(),i(3,"p",26),o(4),b(5,"date"),b(6,"date"),e(),i(7,"p",27),o(8,"con "),i(9,"strong"),o(10),e()(),i(11,"button",28),o(12,"DETTAGLI"),e()()),a&2){let t=s();l(4),Z("",y(5,3,t.nextBooking.start,"fullDate")," \u2013 ",y(6,6,t.nextBooking.start,"HH:mm"),""),l(6),u(t.nextBooking.artist)}}function Te(a,n){if(a&1&&(i(0,"mat-card",29)(1,"mat-icon",30),o(2),e(),i(3,"h4"),o(4),e(),i(5,"p"),o(6),e(),i(7,"button",31),o(8,"VAI"),e()()),a&2){let t=n.$implicit;l(2),u(t.icon),l(2),u(t.title),l(2),u(t.description),l(),c("routerLink","/dashboard/"+t.route)}}function De(a,n){if(a&1&&(i(0,"mat-list-option")(1,"p"),o(2),e()()),a&2){let t=n.$implicit;l(2),u(t.text)}}function Ne(a,n){if(a&1&&(i(0,"mat-card",32)(1,"h3"),o(2,"Checklist pre-seduta"),e(),i(3,"mat-selection-list"),p(4,De,3,1,"mat-list-option",33),e()()),a&2){let t=s();l(4),c("ngForOf",t.checklist)}}var bt=class a{constructor(n,t,r,m){this.fb=n;this.bookingService=t;this.authService=r;this.staffService=m}user=null;profileForm;isEditing=!1;unreadMessagesCount=0;nextBooking=null;lastBooking=null;isUpcomingSoon=!1;notifications=[];checklist=[];sections=[{icon:"event",title:"Storico Prenotazioni",description:"Controlla tutte le tue sedute passate e future.",route:"booking-history"},{icon:"chat",title:"Codici Promo & Buoni",description:"Comunica con il team e ricevi assistenza diretta.",route:"buoni"},{icon:"reviews",title:"Le Tue Recensioni",description:"Gestisci le recensioni lasciate agli artisti.",route:"reviews"},{icon:"settings",title:"Impostazioni",description:"Personalizza le preferenze del tuo account.",route:"settings"}];ngOnInit(){this.profileForm=this.fb.group({name:[""],email:[""],phone:[""],avatar:[""],dateOfBirth:[null],address:[""],city:[""],postalCode:[""],country:[""]});let n=this.authService.getUser();n&&(this.user=n,this.profileForm.patchValue({name:n.name||"",email:n.email||"",phone:n.phone||"",avatar:n.avatar||"https://i.pravatar.cc/150?img=3",dateOfBirth:n.dateOfBirth?new Date(n.dateOfBirth):null,address:n.address||"",city:n.city||"",postalCode:n.postalCode||"",country:n.country||""}),this.loadBookings(n.name),this.notifications=[{message:"Hai una seduta in arrivo!",date:"2025-05-15"}],this.checklist=[{text:"Evitare alcol 24h prima"},{text:"Pelle ben idratata"},{text:"Mangiare prima della seduta"},{text:"Portare documento d\u2019identit\xE0"}],this.notifications=[{icon:"event_available",message:"Hai una seduta prevista per il 10 luglio alle 15:00.",date:"2025-07-08T10:00:00",type:"appointment"},{icon:"star_rate",message:"La tua ultima recensione \xE8 stata approvata!",date:"2025-07-07T09:00:00",type:"review"},{icon:"chat",message:"Hai ricevuto una risposta nel messaggio con lo studio.",date:"2025-07-06T17:30:00",type:"message"}])}loadBookings(n){this.bookingService.getBookingsByClient(n).subscribe(t=>{if(!t?.length)return;let r=t.sort((m,d)=>new Date(m.start).getTime()-new Date(d.start).getTime());this.lastBooking=r[r.length-1],this.nextBooking=r.find(m=>new Date(m.start).getTime()>Date.now()),this.checkIfBookingIsSoon(),this.unreadMessagesCount=3})}toggleEdit(){this.isEditing=!this.isEditing,!this.isEditing&&this.user&&this.profileForm.patchValue(W(E({},this.user),{dateOfBirth:this.user.dateOfBirth?new Date(this.user.dateOfBirth):null}))}scrollTop(){window.scrollTo({top:0,behavior:"smooth"})}saveProfile(){if(this.profileForm.invalid||!this.user)return;let n=this.profileForm.getRawValue();this.user=E(E({},this.user),n),this.authService.updateCurrentUserProfile({name:n.name,avatar:n.avatar,phone:n.phone,dateOfBirth:n.dateOfBirth,address:n.address,city:n.city,postalCode:n.postalCode,country:n.country}).then(()=>{console.log("Profilo aggiornato"),this.toggleEdit()}).catch(t=>{console.error("Errore aggiornamento profilo:",t)})}onAvatarSelected(n){let t=n.target;if(!t.files?.length)return;let r=t.files[0],m=new FileReader;m.onload=()=>{let d=m.result;this.profileForm.patchValue({avatar:d})},m.readAsDataURL(r)}checkIfBookingIsSoon(){if(!this.nextBooking?.start)return;let n=new Date,r=(new Date(this.nextBooking.start).getTime()-n.getTime())/(1e3*60*60*24);this.isUpcomingSoon=r>=0&&r<=3}static \u0275fac=function(t){return new(t||a)(M(V),M(Mt),M(it),M(nt))};static \u0275cmp=O({type:a,selectors:[["app-profile"]],standalone:!0,features:[S],decls:35,vars:16,consts:[["picker",""],[1,"dashboard",3,"formGroup"],[1,"left-pane"],[1,"profile-card"],[1,"avatar-wrapper"],["alt","Avatar",3,"src"],["type","file","accept","image/*",3,"change",4,"ngIf"],[1,"muted"],[1,"profile-form-fields"],["appearance","fill"],["matInput","","formControlName","name",3,"readonly"],["matInput","","formControlName","phone",3,"readonly"],["matInput","","formControlName","dateOfBirth",3,"matDatepicker","readonly"],["matSuffix","",3,"for"],[1,"actions"],["mat-stroked-button","","color","primary",3,"click",4,"ngIf"],["mat-stroked-button","",3,"click",4,"ngIf"],["class","next-booking",4,"ngIf"],[1,"right-pane"],[1,"tile-grid"],["class","tile",4,"ngFor","ngForOf"],["class","checklist",4,"ngIf"],["type","file","accept","image/*",3,"change"],["mat-stroked-button","","color","primary",3,"click"],["mat-stroked-button","",3,"click"],[1,"next-booking"],[1,"date"],[1,"artist"],["mat-stroked-button","","color","primary","routerLink","/clients/booking-history"],[1,"tile"],[1,"tile-icon"],["mat-raised-button","","color","primary",3,"routerLink"],[1,"checklist"],[4,"ngFor","ngForOf"]],template:function(t,r){if(t&1&&(i(0,"section",1)(1,"aside",2)(2,"mat-card",3)(3,"div",4),g(4,"img",5),p(5,Ie,1,0,"input",6),e(),i(6,"h2"),o(7),e(),i(8,"p",7),o(9),e(),i(10,"form",8)(11,"mat-form-field",9)(12,"mat-label"),o(13,"Nome"),e(),g(14,"input",10),e(),i(15,"mat-form-field",9)(16,"mat-label"),o(17,"Telefono"),e(),g(18,"input",11),e(),i(19,"mat-form-field",9)(20,"mat-label"),o(21,"Data di nascita"),e(),g(22,"input",12)(23,"mat-datepicker-toggle",13)(24,"mat-datepicker",null,0),e()(),i(26,"div",14),p(27,Ee,2,0,"button",15)(28,Fe,2,0,"button",15)(29,Be,2,0,"button",16),e()(),p(30,Re,13,9,"mat-card",17),e(),i(31,"main",18)(32,"div",19),p(33,Te,9,4,"mat-card",20),e(),p(34,Ne,5,1,"mat-card",21),e()()),t&2){let m,d=Q(25);c("formGroup",r.profileForm),l(4),c("src",(m=r.profileForm.get("avatar"))==null?null:m.value,L),l(),c("ngIf",r.isEditing),l(2),u(r.profileForm.value.name),l(2),u(r.profileForm.value.email),l(5),c("readonly",!r.isEditing),l(4),c("readonly",!r.isEditing),l(4),c("matDatepicker",d)("readonly",!r.isEditing),l(),c("for",d),l(4),c("ngIf",!r.isEditing),l(),c("ngIf",r.isEditing),l(),c("ngIf",r.isEditing),l(),c("ngIf",r.nextBooking),l(3),c("ngForOf",r.sections),l(),c("ngIf",r.checklist.length)}},dependencies:[Xt,w,F,B,J,I,q,k,ae,re,U,H,G,X,j,_t,vt,Ct,z,$,R,T,D,N,A],styles:[".dashboard[_ngcontent-%COMP%]{display:grid;gap:2rem;grid-template-columns:360px 1fr;padding:8vh 2rem;color:#fff;background:whitesmokesmoke}@media (max-width: 1024px){.dashboard[_ngcontent-%COMP%]{grid-template-columns:1fr}}.tile-icon[_ngcontent-%COMP%]{font-size:2.4rem;color:#fff;margin-bottom:.5rem}.left-pane[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}.profile-card[_ngcontent-%COMP%], .next-booking[_ngcontent-%COMP%], .notice[_ngcontent-%COMP%], .checklist[_ngcontent-%COMP%], .tile[_ngcontent-%COMP%]{background:#111;border-radius:12px;padding:1.5rem;box-shadow:0 4px 12px #00000080}.profile-card[_ngcontent-%COMP%]   .avatar-wrapper[_ngcontent-%COMP%]{position:relative;width:120px;height:120px;margin:0 auto 1rem}.profile-card[_ngcontent-%COMP%]   .avatar-wrapper[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:50%;object-fit:cover;border:4px solid #ffffff}.profile-card[_ngcontent-%COMP%]   .avatar-wrapper[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{position:absolute;inset:0;opacity:0;cursor:pointer}.profile-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;margin:.5rem 0 .25rem;font-size:1.6rem}.profile-card[_ngcontent-%COMP%]   .muted[_ngcontent-%COMP%]{text-align:center;opacity:.7;margin-bottom:1rem;font-size:.9rem}.profile-card[_ngcontent-%COMP%]   .profile-form-fields[_ngcontent-%COMP%]{display:grid;gap:.75rem}.profile-card[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:.75rem;margin-top:1rem;color:#f5f5f5}.profile-card[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:#f5f5f5!important}.right-pane[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}.tile-grid[_ngcontent-%COMP%]{display:grid;gap:1rem;grid-template-columns:repeat(auto-fill,minmax(180px,1fr))}.tile[_ngcontent-%COMP%]{text-align:center}.tile[_ngcontent-%COMP%]   .emoji[_ngcontent-%COMP%]{font-size:2rem;display:block;margin-bottom:.5rem}.tile[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 .25rem;font-size:1.1rem}.tile[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.85rem;opacity:.75;min-height:40px}.item-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;color:#000}.item-label[_ngcontent-%COMP%]   [matBadge][_ngcontent-%COMP%]{transform:translateY(-2px)}.notifications-card[_ngcontent-%COMP%]{margin-top:24px;padding:16px}.notifications-card[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:#000!important}.notifications-card[_ngcontent-%COMP%]   .notification[_ngcontent-%COMP%]{display:flex;align-items:flex-start;margin-bottom:16px}.notifications-card[_ngcontent-%COMP%]   .notification[_ngcontent-%COMP%]   .notif-icon[_ngcontent-%COMP%]{color:#3f51b5;margin-right:12px;font-size:28px}.notifications-card[_ngcontent-%COMP%]   .notification[_ngcontent-%COMP%]   .notif-content[_ngcontent-%COMP%]{flex:1}.notifications-card[_ngcontent-%COMP%]   .notification[_ngcontent-%COMP%]   .notif-content[_ngcontent-%COMP%]   .notif-message[_ngcontent-%COMP%]{margin:0;font-weight:500;color:#000!important}.notifications-card[_ngcontent-%COMP%]   .notification[_ngcontent-%COMP%]   .notif-content[_ngcontent-%COMP%]   .notif-date[_ngcontent-%COMP%]{font-size:12px;color:gray}.notifications-card[_ngcontent-%COMP%]   .no-notif[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:gray;padding:12px 0}.notifications-card[_ngcontent-%COMP%]   .no-notif[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px}.next-booking[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:1.1rem}.next-booking[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{font-weight:600}.next-booking[_ngcontent-%COMP%]   .artist[_ngcontent-%COMP%]{opacity:.85;margin-bottom:1rem}.notice[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .checklist[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 .75rem;font-size:1.1rem;color:#f5f5f5!important}.notice[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .checklist[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#f5f5f5!important}.notice[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%], .notice[_ngcontent-%COMP%]   mat-list-option[_ngcontent-%COMP%], .checklist[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%], .checklist[_ngcontent-%COMP%]   mat-list-option[_ngcontent-%COMP%]{font-size:.9rem}.mat-form-field-appearance-fill[_ngcontent-%COMP%]   .mat-form-field-flex[_ngcontent-%COMP%]{background:#222}button.mat-raised-button[_ngcontent-%COMP%]{background:#fff;color:#000;font-weight:600}button.mat-raised-button[_ngcontent-%COMP%]:hover{filter:brightness(1.1)}"]})};var Ve=()=>[1,2,3,4,5];function ze(a,n){a&1&&(i(0,"mat-error"),o(1,`
Commento obbligatorio (min 10 caratteri)`),e())}function Ge(a,n){if(a&1&&(i(0,"mat-button-toggle",10),o(1),e()),a&2){let t=n.$implicit;c("value",t),l(),C(" ",t," \u2B50 ")}}var kt=class a{constructor(n,t,r,m){this.fb=n;this.dialogRef=t;this.reviewService=r;this.data=m;this.form=this.fb.group({rating:[5,[P.required,P.min(1),P.max(5)]],comment:["",[P.required,P.minLength(10)]]})}form;submit(){if(this.form.invalid)return;let n=W(E({},this.form.value),{userId:this.data?.userId,tattooTitle:this.data.tattooTitle,bookingId:this.data.bookingId,artistId:this.data.artistId,status:"pending",date:Date.now()});this.reviewService.addReview(n).then(()=>{this.dialogRef.close(!0)})}close(){this.dialogRef.close(!1)}static \u0275fac=function(t){return new(t||a)(M(V),M(le),M(ot),M(me))};static \u0275cmp=O({type:a,selectors:[["app-review-create-dialog"]],standalone:!0,features:[S],decls:21,vars:6,consts:[["mat-dialog-title",""],[1,"dialog-body",3,"formGroup"],["appearance","fill"],["matInput","","rows","4","formControlName","comment"],[4,"ngIf"],["formControlName","rating","aria-label","Rating"],[3,"value",4,"ngFor","ngForOf"],["align","end"],["mat-button","",3,"click"],["mat-flat-button","","color","primary",3,"click","disabled"],[3,"value"]],template:function(t,r){t&1&&(i(0,"h2",0),o(1,"Lascia una Recensione"),e(),i(2,"mat-dialog-content",1)(3,"p"),o(4,"Tatuaggio: "),i(5,"strong"),o(6),e()(),i(7,"mat-form-field",2)(8,"mat-label"),o(9,"Commento"),e(),g(10,"textarea",3),p(11,ze,2,0,"mat-error",4),e(),i(12,"mat-label"),o(13,"Valutazione"),e(),i(14,"mat-button-toggle-group",5),p(15,Ge,2,2,"mat-button-toggle",6),e()(),i(16,"mat-dialog-actions",7)(17,"button",8),f("click",function(){return r.close()}),o(18,"Annulla"),e(),i(19,"button",9),f("click",function(){return r.submit()}),o(20," Invia "),e()()),t&2&&(l(2),c("formGroup",r.form),l(4),u(r.data.tattooTitle),l(5),c("ngIf",r.form.controls.comment.invalid),l(4),c("ngForOf",rt(5,Ve)),l(4),c("disabled",r.form.invalid))},dependencies:[w,F,B,z,R,T,D,N,A,I,k,se,de,pe,U,H,G,ge,xt,ht],styles:[".dialog-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px;padding-top:8px}.dialog-body[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}.dialog-body[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:8px}.dialog-body[_ngcontent-%COMP%]   mat-button-toggle[_ngcontent-%COMP%]{flex:1 1 auto;text-align:center}"]})};function He(a,n){if(a&1&&g(0,"img",19),a&2){let t=s(2);c("src",t.artistPhotoMap[t.nextBooking.idArtist],L)}}function Ue(a,n){if(a&1){let t=h();i(0,"mat-card",11),p(1,He,1,1,"img",12),i(2,"h3"),o(3),e(),i(4,"p",13)(5,"mat-icon"),o(6,"calendar_today"),e(),o(7),b(8,"date"),g(9,"br"),o(10),b(11,"date"),e(),i(12,"p",14)(13,"mat-icon"),o(14,"person"),e(),o(15),e(),i(16,"div",15)(17,"button",16)(18,"mat-icon"),o(19,"edit"),e()(),i(20,"button",17),f("click",function(){_(t);let m=s();return v(m.downloadInvoice(m.nextBooking))}),i(21,"mat-icon"),o(22,"receipt_long"),e()(),i(23,"button",18),f("click",function(){_(t);let m=s();return v(m.openWhatsApp(m.nextBooking))}),i(24,"mat-icon"),o(25,"chat"),e()()()()}if(a&2){let t=s();l(),c("ngIf",t.artistPhotoMap[t.nextBooking.idArtist]),l(2),u(t.nextBooking.title),l(4),C(" ",y(8,5,t.nextBooking.start,"fullDate"),""),l(3),C(" ",y(11,8,t.nextBooking.start,"shortTime")," "),l(5),C(" ",t.artistMap[t.nextBooking.idArtist]||"Sconosciuto"," ")}}function je(a,n){if(a&1&&g(0,"img",19),a&2){let t=s().$implicit,r=s();c("src",r.artistPhotoMap[t.idArtist],L)}}function Le(a,n){if(a&1){let t=h();i(0,"mat-card",20),p(1,je,1,1,"img",12),i(2,"h3"),o(3),e(),i(4,"p",13)(5,"mat-icon"),o(6,"calendar_today"),e(),o(7),b(8,"date"),g(9,"br"),o(10),b(11,"date"),e(),i(12,"p",14)(13,"mat-icon"),o(14,"person"),e(),o(15),e(),i(16,"div",15)(17,"button",16)(18,"mat-icon"),o(19,"edit"),e()(),i(20,"button",17),f("click",function(){let m=_(t).$implicit,d=s();return v(d.downloadInvoice(m))}),i(21,"mat-icon"),o(22,"receipt_long"),e()(),i(23,"button",18),f("click",function(){let m=_(t).$implicit,d=s();return v(d.openWhatsApp(m))}),i(24,"mat-icon"),o(25,"chat"),e()()()()}if(a&2){let t=n.$implicit,r=s();l(),c("ngIf",r.artistPhotoMap[t.idArtist]),l(2),u(t.title),l(4),C(" ",y(8,5,t.start,"fullDate"),""),l(3),C(" ",y(11,8,t.start,"shortTime")," "),l(5),C(" ",r.artistMap[t.idArtist]||"Sconosciuto"," ")}}function $e(a,n){a&1&&(i(0,"div",21)(1,"p"),o(2,"Nessuna prenotazione in ritardo"),e()())}function qe(a,n){a&1&&(i(0,"div",21)(1,"p"),o(2,"Nessuna prenotazione completata"),e()())}function We(a,n){a&1&&(i(0,"div",21)(1,"p"),o(2,"Nessuna prenotazione annullata"),e()())}function Qe(a,n){if(a&1&&(i(0,"mat-card",24)(1,"div",25)(2,"strong"),o(3),e(),g(4,"br"),i(5,"small"),o(6),b(7,"date"),e()(),i(8,"mat-chip",26),o(9,"In ritardo"),e()()),a&2){let t=n.$implicit,r=s(2);l(3),u(t.title),l(3),Z("",y(7,3,t.start,"short")," \u2013 ",r.artistMap[t.idArtist],"")}}function Ye(a,n){if(a&1&&(i(0,"div",22),p(1,Qe,10,6,"mat-card",23),e()),a&2){let t=s();c("@slideFade",void 0),l(),c("ngForOf",t.pastUncompleted)}}function Ze(a,n){if(a&1){let t=h();i(0,"button",33),f("click",function(){_(t);let m=s(2).$implicit,d=s(2);return v(d.openReviewDialog(m))}),i(1,"mat-icon"),o(2,"rate_review"),e()()}}function Je(a,n){if(a&1){let t=h();i(0,"button",34),f("click",function(){_(t);let m=s(2).$implicit,d=s(2);return v(d.viewReview(d.reviewMap[m.id]))}),i(1,"mat-icon"),o(2,"visibility"),e()()}}function Ke(a,n){if(a&1&&(Tt(0),p(1,Ze,3,0,"button",31)(2,Je,3,0,"button",32),Dt()),a&2){let t=s().$implicit,r=s(2);l(),c("ngIf",!r.reviewMap[t.id]),l(),c("ngIf",r.reviewMap[t.id])}}function Xe(a,n){if(a&1){let t=h();i(0,"mat-card",28)(1,"div",25)(2,"strong"),o(3),e(),g(4,"br"),i(5,"small"),o(6),b(7,"date"),e()(),i(8,"div",15)(9,"button",29),f("click",function(){let m=_(t).$implicit,d=s(2);return v(d.downloadInvoice(m))}),i(10,"mat-icon"),o(11,"receipt_long"),e()(),p(12,Ke,3,2,"ng-container",30),e()()}if(a&2){let t=n.$implicit,r=s(2);l(3),u(t.title),l(3),Z("",y(7,4,t.start,"short")," \u2013 ",r.artistMap[t.idArtist],""),l(6),c("ngIf",t.status==="completed")}}function ti(a,n){if(a&1&&(i(0,"div",22),p(1,Xe,13,7,"mat-card",27),e()),a&2){let t=s();c("@slideFade",void 0),l(),c("ngForOf",t.completedBookings)}}function ei(a,n){if(a&1&&(i(0,"mat-card",36)(1,"div",25)(2,"strong"),o(3),e(),g(4,"br"),i(5,"small"),o(6),b(7,"date"),e()()()),a&2){let t=n.$implicit,r=s(2);l(3),u(t.title),l(3),Z("",y(7,3,t.start,"short")," \u2013 ",r.artistMap[t.idArtist],"")}}function ii(a,n){if(a&1&&(i(0,"div",22),p(1,ei,8,6,"mat-card",35),e()),a&2){let t=s();c("@slideFade",void 0),l(),c("ngForOf",t.cancelledBookings)}}var It=class a{auth=x(it);bookingService=x(Mt);staffService=x(nt);snackbar=x(ut);dialog=x(ce);reviewsService=x(ot);router=x(Kt);selectedView="completed";WHATSAPP_NUMBER="393333333333";user;reviewMap={};bookings=[];nextBooking=null;pastUncompleted=[];completedBookings=[];cancelledBookings=[];otherUpcomingBookings=[];artistMap={};artistPhotoMap={};ngOnInit(){return Gt(this,null,function*(){if(this.user=E({},yield this.auth.waitForUser()),!this.user)return;let n=new Date().toISOString();this.reviewsService.getReviewsByUser(this.user?.uid).subscribe(t=>{this.reviewMap={};for(let r of t)r.bookingId&&(this.reviewMap[r.bookingId]=r)}),this.staffService.getAllStaff().subscribe(t=>{this.artistMap=t.reduce((r,m)=>W(E({},r),{[m.id]:m.name}),{}),this.artistPhotoMap=t.reduce((r,m)=>W(E({},r),{[m.id]:m.photoUrl||""}),{})}),this.bookingService.getBookingsByClient(this.user.uid).subscribe(t=>{this.bookings=t.sort((m,d)=>new Date(m.start).getTime()-new Date(d.start).getTime()),this.pastUncompleted=t.filter(m=>["draft","paid","on-going"].includes(m.status)&&m.start<n),this.completedBookings=t.filter(m=>m.status==="completed"),this.cancelledBookings=t.filter(m=>m.status==="cancelled");let r=t.filter(m=>["draft","paid","on-going"].includes(m.status)&&m.start>=n).sort((m,d)=>new Date(m.start).getTime()-new Date(d.start).getTime());this.nextBooking=r[0]??null,this.otherUpcomingBookings=r.slice(1)})})}downloadInvoice(n){this.snackbar.open(`Fattura per "${n.title}" scaricata. (Simulazione)`,"Chiudi",{duration:3e3})}openWhatsApp(n){let t=encodeURIComponent(`Ciao! Ti scrivo per la prenotazione "${n.title}" prevista per il ${new Date(n.start).toLocaleDateString()} alle ${new Date(n.start).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}.`),r=`https://wa.me/${this.WHATSAPP_NUMBER}?text=${t}`;window.open(r,"_blank")}openReviewDialog(n){let t=this.user?.uid||this.user?.user?.uid||null;if(!t){this.snackbar.open("Errore: utente non autenticato.","Chiudi",{duration:3e3});return}this.dialog.open(kt,{data:{bookingId:n.id,tattooTitle:n.title,artistId:n.idArtist,userId:t}}).afterClosed().subscribe(m=>{m&&(this.snackbar.open("Grazie per la tua recensione!","Chiudi",{duration:3e3}),this.reviewMap[n.id]={id:"temp",comment:"placeholder",rating:5,bookingId:n.id})})}viewReview(n){this.router.navigateByUrl("/dashboard/reviews")}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=O({type:a,selectors:[["app-booking-history"]],standalone:!0,features:[S],decls:27,vars:16,consts:[[1,"booking-history"],[1,"title"],[1,"horizontal-scroll"],["class","vertical-card highlight",4,"ngIf"],["class","vertical-card",4,"ngFor","ngForOf"],[1,"tab-toggle"],["mat-button","",3,"click"],[1,"booking-content"],[3,"ngSwitch"],["class","empty",4,"ngIf"],["class","container-card",4,"ngSwitchCase"],[1,"vertical-card","highlight"],["alt","Avatar artista","class","avatar",3,"src",4,"ngIf"],[1,"date"],[1,"artist"],[1,"actions"],["mat-icon-button","","matTooltip","Modifica"],["mat-icon-button","","matTooltip","Fattura",3,"click"],["mat-icon-button","","matTooltip","Chat",3,"click"],["alt","Avatar artista",1,"avatar",3,"src"],[1,"vertical-card"],[1,"empty"],[1,"container-card"],["class","booking-card late",4,"ngFor","ngForOf"],[1,"booking-card","late"],[1,"info"],["color","warn","selected",""],["class","booking-card completed",4,"ngFor","ngForOf"],[1,"booking-card","completed"],["mat-icon-button","","matTooltip","Scarica fattura",3,"click"],[4,"ngIf"],["mat-icon-button","","color","accent","matTooltip","Lascia una recensione",3,"click",4,"ngIf"],["mat-icon-button","","color","primary","matTooltip","Visualizza recensione",3,"click",4,"ngIf"],["mat-icon-button","","color","accent","matTooltip","Lascia una recensione",3,"click"],["mat-icon-button","","color","primary","matTooltip","Visualizza recensione",3,"click"],["class","booking-card cancelled",4,"ngFor","ngForOf"],[1,"booking-card","cancelled"]],template:function(t,r){t&1&&(i(0,"section",0)(1,"h2",1)(2,"mat-icon"),o(3,"book_online"),e(),o(4," Le tue prenotazioni in Corso "),e(),i(5,"div",2),p(6,Ue,26,11,"mat-card",3)(7,Le,26,11,"mat-card",4),e(),i(8,"h3",1)(9,"mat-icon"),o(10,"book_online"),e(),o(11," Storico Prenotazioni "),e(),i(12,"div",5)(13,"button",6),f("click",function(){return r.selectedView="late"}),o(14,"Ritardi"),e(),i(15,"button",6),f("click",function(){return r.selectedView="completed"}),o(16,"Completate"),e(),i(17,"button",6),f("click",function(){return r.selectedView="cancelled"}),o(18,"Annullate"),e()(),i(19,"div",7),Tt(20,8),p(21,$e,3,0,"div",9)(22,qe,3,0,"div",9)(23,We,3,0,"div",9)(24,Ye,2,2,"div",10)(25,ti,2,2,"div",10)(26,ii,2,2,"div",10),Dt(),e()()),t&2&&(l(6),c("ngIf",r.nextBooking),l(),c("ngForOf",r.otherUpcomingBookings),l(6),st("active",r.selectedView==="late"),l(2),st("active",r.selectedView==="completed"),l(2),st("active",r.selectedView==="cancelled"),l(2),c("@slideFade",void 0),l(),c("ngSwitch",r.selectedView),l(),c("ngIf",r.selectedView==="late"&&r.pastUncompleted.length===0),l(),c("ngIf",r.selectedView==="completed"&&r.completedBookings.length===0),l(),c("ngIf",r.selectedView==="cancelled"&&r.cancelledBookings.length===0),l(),c("ngSwitchCase","late"),l(),c("ngSwitchCase","completed"),l(),c("ngSwitchCase","cancelled"))},dependencies:[w,F,B,Yt,Zt,J,I,q,k,K,j,et],styles:[".booking-history[_ngcontent-%COMP%]{padding:16px;background:#f8f7fb;min-height:100vh}.booking-history[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;align-items:center;font-weight:700;font-size:20px;margin-bottom:12px}.booking-history[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px}.booking-history[_ngcontent-%COMP%]   .next-booking[_ngcontent-%COMP%]{background:#e9e9e7;border-left:4px solid #000000;padding:16px;margin-bottom:16px;border-radius:16px;box-shadow:0 4px 12px #0000000d}.booking-history[_ngcontent-%COMP%]   .next-booking[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.booking-history[_ngcontent-%COMP%]   .next-booking[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:50%}.booking-history[_ngcontent-%COMP%]   .next-booking[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:6px;font-size:16px}.booking-history[_ngcontent-%COMP%]   .next-booking[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:13px;margin:6px 0;display:flex;align-items:center;gap:4px}.booking-history[_ngcontent-%COMP%]   .next-booking[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{margin-top:8px;display:flex;justify-content:flex-end}.booking-history[_ngcontent-%COMP%]   .next-booking[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{transition:transform .2s ease}.booking-history[_ngcontent-%COMP%]   .next-booking[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.booking-history[_ngcontent-%COMP%]   .tab-toggle[_ngcontent-%COMP%]{display:flex;gap:12px;margin:24px 0}.booking-history[_ngcontent-%COMP%]   .tab-toggle[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;padding:8px 16px;font-weight:600;border-radius:20px;background-color:#e0e0e0;color:#444}.booking-history[_ngcontent-%COMP%]   .tab-toggle[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background-color:#3f51b5;color:#fff}.booking-history[_ngcontent-%COMP%]   .booking-card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:16px;margin-bottom:12px;box-shadow:0 4px 8px #0000000a}.booking-history[_ngcontent-%COMP%]   .booking-card.completed[_ngcontent-%COMP%]{border-left:4px solid #4caf50}.booking-history[_ngcontent-%COMP%]   .booking-card.cancelled[_ngcontent-%COMP%]{border-left:4px solid #f44336}.booking-history[_ngcontent-%COMP%]   .booking-card[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:15px}.booking-history[_ngcontent-%COMP%]   .booking-card[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:13px;color:#666}.booking-card.late[_ngcontent-%COMP%]{border-left:4px solid #ff9800;background:#fff3e0}.booking-card.late[_ngcontent-%COMP%]   mat-chip[_ngcontent-%COMP%]{margin-top:8px;font-size:12px}.container-card[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;gap:12px}.container-card[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{min-width:300px;max-width:300px}.next-booking.secondary[_ngcontent-%COMP%]{margin-top:16px;background:#f6f6f6}.empty[_ngcontent-%COMP%]{text-align:center;padding:24px;color:#888;font-style:italic}.horizontal-scroll[_ngcontent-%COMP%]{display:flex;gap:16px;overflow-x:auto;padding:1rem 0;scroll-snap-type:x mandatory}.vertical-card[_ngcontent-%COMP%]{flex:0 0 auto;width:240px;min-height:320px;padding:16px;display:flex;flex-direction:column;justify-content:space-between;align-items:center;scroll-snap-align:start;text-align:center;border:1px solid #ddd}.vertical-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:.5rem 0 .25rem;font-size:1.1rem}.vertical-card[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{width:72px;height:72px;border-radius:50%;object-fit:cover;margin-bottom:8px;border:2px solid #ccc}.vertical-card[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%], .vertical-card[_ngcontent-%COMP%]   .artist[_ngcontent-%COMP%]{font-size:.85rem;color:#444;margin:2px 0;display:flex;align-items:center;justify-content:center}.vertical-card[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .vertical-card[_ngcontent-%COMP%]   .artist[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;margin-right:4px}.vertical-card[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{margin-top:auto;display:flex;justify-content:center;gap:8px}.vertical-card.highlight[_ngcontent-%COMP%]{border:2px solid #3f51b5;background:#e3f2fd}.actions[_ngcontent-%COMP%]   button[mat-icon-button][_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:22px}button[mat-icon-button][color=accent][_ngcontent-%COMP%]{color:#ff9800}"],data:{animation:[ee("slideFade",[Vt(":enter",[dt({opacity:0,transform:"translateY(12px)"}),At("300ms ease-out",dt({opacity:1,transform:"translateY(0)"}))]),Vt(":leave",[At("200ms ease-in",dt({opacity:0,transform:"translateY(8px)"}))])])]}})};var oi=["reviewDrawer"],Pe=()=>[1,2,3,4,5];function ri(a,n){a&1&&(i(0,"div",27)(1,"mat-icon"),o(2,"rate_review"),e(),i(3,"p"),o(4,"Nessuna recensione trovata."),e()())}function ai(a,n){if(a&1&&g(0,"img",37),a&2){let t=s().$implicit,r=s();c("src",r.getArtistPhotoById(t.artistId),L)}}function li(a,n){if(a&1&&(i(0,"mat-icon"),o(1),e()),a&2){let t=n.$implicit,r=s().$implicit;l(),C(" ",t<=r.rating?"star":"star_border"," ")}}function mi(a,n){a&1&&(i(0,"mat-chip",38),o(1,"PENDING"),e())}function ci(a,n){a&1&&(i(0,"mat-chip",38),o(1,"RIFIUTATA"),e())}function si(a,n){if(a&1){let t=h();i(0,"button",39),f("click",function(){_(t);let m=s().$implicit,d=s();return v(d.editReview(m))}),i(1,"mat-icon"),o(2,"edit"),e()()}}function pi(a,n){if(a&1){let t=h();i(0,"button",40),f("click",function(){_(t);let m=s().$implicit,d=s();return v(d.deleteReview(m.id))}),i(1,"mat-icon"),o(2,"delete"),e()()}}function di(a,n){if(a&1&&(i(0,"mat-card",28)(1,"mat-card-header")(2,"div",29),p(3,ai,1,1,"img",30),e(),i(4,"mat-card-title"),o(5),e(),i(6,"mat-card-subtitle"),o(7),b(8,"date"),e()(),i(9,"mat-card-content")(10,"p",31),o(11),e(),i(12,"div",32),p(13,li,2,1,"mat-icon",33),e(),p(14,mi,2,0,"mat-chip",34)(15,ci,2,0,"mat-chip",34),e(),i(16,"mat-card-actions"),p(17,si,3,0,"button",35)(18,pi,3,0,"button",36),e()()),a&2){let t=n.$implicit,r=s();l(3),c("ngIf",r.getArtistPhotoById(t.artistId)),l(2),u(r.getArtistNameById(t.artistId)),l(2),u(y(8,9,t.date,"longDate")),l(4),C('"',t.comment,'"'),l(2),c("ngForOf",rt(12,Pe)),l(),c("ngIf",t.status==="pending"),l(),c("ngIf",t.status==="rejected"),l(2),c("ngIf",r.canEditReview(t)),l(),c("ngIf",t.status!=="approved")}}function gi(a,n){if(a&1&&g(0,"img",44),a&2){let t=s().$implicit;c("src",t.photoUrl,L)}}function fi(a,n){if(a&1&&(i(0,"mat-option",41)(1,"div",42),p(2,gi,1,1,"img",43),o(3),e()()),a&2){let t=n.$implicit;c("value",t.name),l(2),c("ngIf",t.photoUrl),l(),C(" ",t.name," ")}}function ui(a,n){if(a&1&&(i(0,"mat-button-toggle",41),o(1),e()),a&2){let t=n.$implicit;c("value",t),l(),C("",t," \u2B50")}}var Et=class a{auth=x(it);fb=x(V);snackbar=x(ut);reviewsService=x(ot);staffService=x(nt);MatTooltipModule=x(Ce);reviewDrawer;user;reviews=[];artists=[];filteredArtists=new Ht;filterStatusCtrl=this.fb.control("all");reviewForm;artistCtrl=this.fb.control("");selectedArtistId="";selectedReview=null;ngOnInit(){this.auth.waitForUser().then(n=>{this.user=n,this.loadData()}),this.reviewForm=this.fb.group({author:[{value:"",disabled:!0},P.required],comment:["",[P.required,P.minLength(10)]],rating:[5,P.required],artistId:[""]})}editReview(n){this.selectedReview=n,this.reviewForm.patchValue({author:this.user.name,comment:n.comment,rating:n.rating}),this.artistCtrl.setValue(this.getArtistNameById(n.artistId)),this.selectedArtistId=n.artistId||"",this.reviewDrawer.open()}canEditReview(n){let t=Date.now(),r=5*60*1e3;return t-n.date<=r}toggleDrawer(){this.reviewDrawer?.opened?(this.reviewDrawer.close(),this.selectedReview=null):this.openEmptyDrawer()}loadData(){this.user?.uid&&(this.reviewsService.getReviewsByUser(this.user.uid).subscribe(n=>{this.reviews=n.sort((t,r)=>r.date-t.date)}),this.staffService.getAllStaff().subscribe(n=>{this.artists=n,this.filteredArtists=this.artistCtrl.valueChanges.pipe(jt(""),Ut(t=>this._filterArtists(t||"")))}),this.reviewForm.get("author")?.setValue(this.user.name||this.user.email))}_filterArtists(n){let t=n.toLowerCase();return this.artists.filter(r=>r.name.toLowerCase().includes(t))}getArtistNameById(n){return n&&this.artists.find(r=>r.id===n)?.name||"Artista"}getArtistPhotoById(n){return n&&this.artists.find(r=>r.id===n)?.photoUrl||null}openEmptyDrawer(){this.selectedReview=null,this.reviewForm.enable(),this.reviewForm.reset({author:this.user.name,comment:"",rating:5}),this.artistCtrl.enable(),this.artistCtrl.setValue(""),this.selectedArtistId="",this.reviewDrawer.open()}viewReview(n){this.selectedReview=n,this.reviewForm.reset({author:this.user.name,comment:n.comment,rating:n.rating});let t=this.artists.find(r=>r.id===n.artistId);t&&(this.artistCtrl.setValue(t.name),this.selectedArtistId=t.id),this.reviewForm.disable(),this.artistCtrl.disable(),this.reviewDrawer.open()}selectArtist(n){this.artistCtrl.setValue(n.name),this.selectedArtistId=n.id}submitReview(){if(!this.reviewForm.invalid)if(this.selectedReview){if(!this.canEditReview(this.selectedReview)){this.snackbar.open("Modifica non consentita: tempo scaduto.","Chiudi",{duration:3e3});return}let n={comment:this.reviewForm.value.comment,rating:this.reviewForm.value.rating,artistId:this.selectedArtistId};this.reviewsService.updateReview(this.selectedReview.id,n).then(()=>{this.snackbar.open("Recensione aggiornata.","Chiudi",{duration:3e3}),this.closeDrawerAndReset()})}else{let n={id:"",userId:this.user.uid,tattooTitle:"Altro",comment:this.reviewForm.value.comment,rating:this.reviewForm.value.rating,status:"pending",date:Date.now(),artistId:this.selectedArtistId};this.reviewsService.addReview(n).then(()=>{this.snackbar.open("Recensione inviata! In attesa di approvazione.","Chiudi",{duration:3e3}),this.closeDrawerAndReset()})}}closeDrawerAndReset(){this.reviewForm.reset({author:this.user.name,comment:"",rating:5}),this.artistCtrl.setValue(""),this.selectedArtistId="",this.selectedReview=null,this.reviewDrawer.close(),this.loadData()}deleteReview(n){confirm("Confermi di voler eliminare la recensione?")&&this.reviewsService.deleteReview(n).then(()=>{this.snackbar.open("Recensione eliminata.","Chiudi",{duration:3e3}),this.loadData()})}filteredReviews(){let n=this.filterStatusCtrl.value;return n==="all"?this.reviews:this.reviews.filter(t=>t.status===n)}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=O({type:a,selectors:[["app-reviews"]],viewQuery:function(t,r){if(t&1&&Lt(oi,5),t&2){let m;$t(m=qt())&&(r.reviewDrawer=m.first)}},standalone:!0,features:[S],decls:54,vars:17,consts:[["reviewDrawer",""],["auto","matAutocomplete"],["autosize","",1,"drawer-container"],[1,"reviews-section"],[1,"section-header"],[1,"title"],["mat-icon-button","","color","primary",3,"click"],[1,"status-toggle",3,"formControl"],["value","all"],["value","approved"],["value","pending"],["value","rejected"],["class","no-reviews",4,"ngIf"],[1,"review-grid"],["class","review-card",4,"ngFor","ngForOf"],["position","end","mode","side",1,"review-drawer"],[1,"form-title"],[1,"review-form",3,"ngSubmit","formGroup"],["appearance","fill"],["matInput","","formControlName","author",3,"disabled"],["matInput","",3,"formControl","matAutocomplete"],[3,"optionSelected"],[3,"value",4,"ngFor","ngForOf"],["matInput","","rows","4","formControlName","comment"],[1,"rating-group"],["formControlName","rating",1,"rating-toggle"],["mat-flat-button","","color","primary","type","submit",3,"disabled"],[1,"no-reviews"],[1,"review-card"],["mat-card-avatar","",1,"avatar"],["alt","Artista",3,"src",4,"ngIf"],[1,"comment"],[1,"stars"],[4,"ngFor","ngForOf"],["color","warn",4,"ngIf"],["mat-icon-button","","color","primary","matTooltip","Modifica recensione",3,"click",4,"ngIf"],["mat-icon-button","","color","warn","matTooltip","Elimina recensione",3,"click",4,"ngIf"],["alt","Artista",3,"src"],["color","warn"],["mat-icon-button","","color","primary","matTooltip","Modifica recensione",3,"click"],["mat-icon-button","","color","warn","matTooltip","Elimina recensione",3,"click"],[3,"value"],[1,"option-content"],["class","option-avatar",3,"src",4,"ngIf"],[1,"option-avatar",3,"src"]],template:function(t,r){if(t&1){let m=h();i(0,"mat-drawer-container",2)(1,"mat-drawer-content")(2,"section",3)(3,"div",4)(4,"h2",5)(5,"mat-icon"),o(6,"reviews"),e(),o(7," Le tue recensioni "),e(),i(8,"button",6),f("click",function(){return _(m),v(r.toggleDrawer())}),i(9,"mat-icon"),o(10),e()()(),i(11,"mat-button-toggle-group",7)(12,"mat-button-toggle",8),o(13,"Tutte"),e(),i(14,"mat-button-toggle",9),o(15,"Approvate"),e(),i(16,"mat-button-toggle",10),o(17,"In attesa"),e(),i(18,"mat-button-toggle",11),o(19,"Rifiutate"),e()(),p(20,ri,5,0,"div",12),i(21,"div",13),p(22,di,19,13,"mat-card",14),e()()(),i(23,"mat-drawer",15,0)(25,"button",6),f("click",function(){return _(m),v(r.toggleDrawer())}),i(26,"mat-icon"),o(27),e()(),i(28,"h3",16),o(29),e(),i(30,"form",17),f("ngSubmit",function(){return _(m),v(r.submitReview())}),i(31,"mat-form-field",18)(32,"mat-label"),o(33,"Autore"),e(),g(34,"input",19),e(),i(35,"mat-form-field",18)(36,"mat-label"),o(37,"Artista"),e(),g(38,"input",20),i(39,"mat-autocomplete",21,1),f("optionSelected",function(Se){return _(m),v(r.selectArtist(Se.option.value))}),p(41,fi,4,3,"mat-option",22),b(42,"async"),e()(),i(43,"mat-form-field",18)(44,"mat-label"),o(45,"Commento"),e(),g(46,"textarea",23),e(),i(47,"div",24)(48,"mat-label"),o(49,"Valutazione"),e(),i(50,"mat-button-toggle-group",25),p(51,ui,2,2,"mat-button-toggle",22),e()(),i(52,"button",26),o(53),e()()()()}if(t&2){let m=Q(24),d=Q(40);l(10),u(m!=null&&m.opened?"close":"add"),l(),c("formControl",r.filterStatusCtrl),l(9),c("ngIf",r.filteredReviews().length===0),l(2),c("ngForOf",r.filteredReviews()),l(5),u(m!=null&&m.opened?"close":"add"),l(2),C(" ",r.selectedReview?"Dettaglio recensione":"Nuova recensione"," "),l(),c("formGroup",r.reviewForm),l(4),c("disabled",!0),l(4),c("formControl",r.artistCtrl)("matAutocomplete",d),l(3),c("ngForOf",Wt(42,14,r.filteredArtists)),l(10),c("ngForOf",rt(16,Pe)),l(),c("disabled",r.reviewForm.invalid),l(),C(" ",r.selectedReview?"Chiudi":"Invia recensione"," ")}},dependencies:[w,F,B,Jt,J,I,q,k,K,ne,oe,ie,U,H,G,j,ue,_e,gt,ft,fe,tt,xt,ht,pt,et,be,we,z,$,R,T,D,te,N,A],styles:[".drawer-container[_ngcontent-%COMP%]{height:100%}.reviews-section[_ngcontent-%COMP%]{padding:16px}.reviews-section[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}.reviews-section[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.reviews-section[_ngcontent-%COMP%]   .status-toggle[_ngcontent-%COMP%]{margin-bottom:16px}.reviews-section[_ngcontent-%COMP%]   .no-reviews[_ngcontent-%COMP%]{text-align:center;color:gray;padding:32px 0}.reviews-section[_ngcontent-%COMP%]   .no-reviews[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;margin-bottom:8px}.reviews-section[_ngcontent-%COMP%]   .review-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:16px}.reviews-section[_ngcontent-%COMP%]   .review-card[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;object-fit:cover}.reviews-section[_ngcontent-%COMP%]   .review-card[_ngcontent-%COMP%]   .comment[_ngcontent-%COMP%]{font-style:italic;margin:12px 0}.reviews-section[_ngcontent-%COMP%]   .review-card[_ngcontent-%COMP%]   .stars[_ngcontent-%COMP%]{color:#ffb400}.reviews-section[_ngcontent-%COMP%]   .review-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.review-drawer[_ngcontent-%COMP%]{width:350px;padding:24px}.review-drawer[_ngcontent-%COMP%]   .form-title[_ngcontent-%COMP%]{margin-bottom:16px;font-size:1.25rem}.review-drawer[_ngcontent-%COMP%]   .review-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.review-drawer[_ngcontent-%COMP%]   .review-form[_ngcontent-%COMP%]   .rating-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.review-drawer[_ngcontent-%COMP%]   .review-form[_ngcontent-%COMP%]   .rating-group[_ngcontent-%COMP%]   .rating-toggle[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.review-drawer[_ngcontent-%COMP%]   .review-form[_ngcontent-%COMP%]   .option-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.review-drawer[_ngcontent-%COMP%]   .review-form[_ngcontent-%COMP%]   .option-content[_ngcontent-%COMP%]   .option-avatar[_ngcontent-%COMP%]{width:24px;height:24px;border-radius:50%;object-fit:cover}"]})};var Ft=class a{constructor(n){this.fb=n}profileForm;securityForm;notificationForm;tattooPrefsForm;privacyForm;ngOnInit(){this.profileForm=this.fb.group({fullName:[""],email:[""],phone:[""],dob:[null],gender:[""]}),this.securityForm=this.fb.group({currentPassword:[""],newPassword:[""]}),this.notificationForm=this.fb.group({notifyPromotions:[!0],notifyReminders:[!0],notifyNews:[!1]}),this.tattooPrefsForm=this.fb.group({style:[""],zone:[""],artist:[""],isFirstTattoo:[!1]}),this.privacyForm=this.fb.group({acceptMarketing:[!0]})}static \u0275fac=function(t){return new(t||a)(M(V))};static \u0275cmp=O({type:a,selectors:[["app-settings"]],standalone:!0,features:[S],decls:109,vars:8,consts:[["dobPicker",""],[1,"user-settings"],[1,"section-title"],[1,"settings-card"],[3,"formGroup"],["appearance","fill"],["matInput","","formControlName","fullName"],["matInput","","formControlName","email","type","email"],["matInput","","formControlName","phone"],["matInput","","formControlName","dob",3,"matDatepicker"],["matSuffix","",3,"for"],["formControlName","gender"],["value",""],["value","male"],["value","female"],["value","other"],["mat-flat-button","","color","primary"],["matInput","","type","password","formControlName","currentPassword"],["matInput","","type","password","formControlName","newPassword"],["mat-flat-button","","color","warn"],["formControlName","notifyPromotions"],[1,"notification-text"],["formControlName","notifyReminders"],["formControlName","notifyNews"],["formControlName","style"],["value","realistico"],["value","minimal"],["value","geometrico"],["value","oldschool"],["value","tribale"],["matInput","","formControlName","zone"],["matInput","","formControlName","artist"],["formControlName","isFirstTattoo"],[2,"color","white"],["formControlName","acceptMarketing"],["href","/assets/documents/privacy-policy.pdf","target","_blank"],["mat-stroked-button","","color","warn"]],template:function(t,r){if(t&1&&(i(0,"section",1)(1,"h2",2),o(2),e(),i(3,"mat-card",3)(4,"mat-card-title"),o(5,"Profilo personale"),e(),i(6,"form",4)(7,"mat-form-field",5)(8,"mat-label"),o(9,"Nome completo"),e(),g(10,"input",6),e(),i(11,"mat-form-field",5)(12,"mat-label"),o(13,"Email"),e(),g(14,"input",7),e(),i(15,"mat-form-field",5)(16,"mat-label"),o(17,"Telefono"),e(),g(18,"input",8),e(),i(19,"mat-form-field",5)(20,"mat-label"),o(21,"Data di nascita"),e(),g(22,"input",9)(23,"mat-datepicker-toggle",10)(24,"mat-datepicker",null,0),e(),i(26,"mat-form-field",5)(27,"mat-label"),o(28,"Genere"),e(),i(29,"mat-select",11)(30,"mat-option",12),o(31,"Non specificato"),e(),i(32,"mat-option",13),o(33,"Maschio"),e(),i(34,"mat-option",14),o(35,"Femmina"),e(),i(36,"mat-option",15),o(37,"Altro"),e()()(),i(38,"button",16),o(39,"Salva modifiche"),e()()(),i(40,"mat-card",3)(41,"mat-card-title"),o(42,"Sicurezza"),e(),i(43,"form",4)(44,"mat-form-field",5)(45,"mat-label"),o(46,"Password attuale"),e(),g(47,"input",17),e(),i(48,"mat-form-field",5)(49,"mat-label"),o(50,"Nuova password"),e(),g(51,"input",18),e(),i(52,"button",19),o(53,"Aggiorna password"),e()()(),i(54,"mat-card",3)(55,"mat-card-title"),o(56,"Notifiche"),e(),i(57,"form",4)(58,"mat-slide-toggle",20)(59,"span",21),o(60,"Email promozionali"),e()(),i(61,"mat-slide-toggle",22)(62,"span",21),o(63,"Promemoria appuntamenti"),e()(),i(64,"mat-slide-toggle",23)(65,"span",21),o(66,"Newsletter Rebis"),e()()()(),i(67,"mat-card",3)(68,"mat-card-title"),o(69,"Preferenze Tattoo"),e(),i(70,"form",4)(71,"mat-form-field",5)(72,"mat-label"),o(73,"Stile preferito"),e(),i(74,"mat-select",24)(75,"mat-option",25),o(76,"Realistico"),e(),i(77,"mat-option",26),o(78,"Minimal"),e(),i(79,"mat-option",27),o(80,"Geometrico"),e(),i(81,"mat-option",28),o(82,"Old School"),e(),i(83,"mat-option",29),o(84,"Tribale"),e()()(),i(85,"mat-form-field",5)(86,"mat-label"),o(87,"Zona preferita"),e(),g(88,"input",30),e(),i(89,"mat-form-field",5)(90,"mat-label"),o(91,"Artista preferito"),e(),g(92,"input",31),e(),i(93,"mat-checkbox",32)(94,"span",33),o(95,"Primo tatuaggio"),e()(),i(96,"button",16),o(97,"Salva preferenze"),e()()(),i(98,"mat-card",3)(99,"mat-card-title"),o(100,"Privacy e consensi"),e(),i(101,"form",4)(102,"mat-slide-toggle",34),o(103,"Consenso marketing"),e()(),i(104,"p")(105,"a",35),o(106,"Scarica informativa privacy"),e()(),i(107,"button",36),o(108,"Elimina account"),e()()()),t&2){let m=Q(25);l(2),u("Impostazioni Utente".toUpperCase()),l(4),c("formGroup",r.profileForm),l(16),c("matDatepicker",m),l(),c("for",m),l(20),c("formGroup",r.securityForm),l(14),c("formGroup",r.notificationForm),l(13),c("formGroup",r.tattooPrefsForm),l(31),c("formGroup",r.privacyForm)}},dependencies:[w,I,k,U,H,G,X,j,tt,_t,vt,Ct,xe,pt,ve,he,z,$,R,T,D,N,A],styles:[".user-settings[_ngcontent-%COMP%]{padding:8vh 2rem;background:#111;color:#f5f5f5;display:flex;flex-direction:column;gap:2rem;font-family:Barlow Semi Condensed,sans-serif}.section-title[_ngcontent-%COMP%]{font-size:2rem;font-weight:600;text-align:center;color:#d4af37;margin-bottom:1rem}.settings-card[_ngcontent-%COMP%]{background:#1a1a1a;color:#f5f5f5;border-radius:12px;padding:1.5rem;box-shadow:0 0 12px #0000004d;display:flex;flex-direction:column;gap:1rem}.settings-card[_ngcontent-%COMP%]   .notification-text[_ngcontent-%COMP%]{color:#fff}mat-form-field[_ngcontent-%COMP%], mat-slide-toggle[_ngcontent-%COMP%], mat-checkbox[_ngcontent-%COMP%]{width:100%;margin:12px;max-width:250px}button[_ngcontent-%COMP%]{align-self:flex-start}@media (max-width: 768px){.user-settings[_ngcontent-%COMP%]{padding:8vh 1rem}}"]})};function _i(a,n){if(a&1&&(i(0,"mat-icon",19),o(1),e()),a&2){let t=s();l(),u(t.promoStatusIcon)}}function vi(a,n){if(a&1&&(i(0,"p",20),o(1),e()),a&2){let t=s();c("ngClass",t.promoStatusColor),l(),u(t.promoStatus)}}function Ci(a,n){if(a&1&&(i(0,"p",21),o(1),e()),a&2){let t=s();l(),u(t.copyMessage)}}function xi(a,n){if(a&1&&(i(0,"mat-chip",22),o(1),e()),a&2){let t=n.$implicit;l(),C(" \u{1F389} ",t," ")}}var Bt=class a{constructor(n){this.fb=n}promoForm;promoStatus="";promoStatusColor;promoStatusIcon="";copyMessage="";userReferralCode="REBIS123";completedReferrals=["Ricevuto bonus per invito completato!","Ricevuto bonus per invito completato!","Ricevuto bonus per invito completato!"];ngOnInit(){this.promoForm=this.fb.group({code:["",P.required]})}applyPromo(){let n=this.promoForm.value.code.trim().toUpperCase();["SUMMER25","REBIS10","WELCOME5"].includes(n)?(this.promoStatus=`\u2705 Codice "${n}" applicato con successo!`,this.promoStatusColor="primary",this.promoStatusIcon="check_circle"):(this.promoStatus=`\u274C Codice "${n}" non valido.`,this.promoStatusColor="warn",this.promoStatusIcon="error"),this.promoForm.reset()}copyReferralCode(){navigator.clipboard.writeText(this.userReferralCode).then(()=>{this.copyMessage="Codice copiato negli appunti!",setTimeout(()=>this.copyMessage="",2500)})}static \u0275fac=function(t){return new(t||a)(M(V))};static \u0275cmp=O({type:a,selectors:[["app-promo-referral"]],standalone:!0,features:[S],decls:44,vars:10,consts:[[1,"promo-referral-container"],[1,"promo-card"],[1,"promo-icon"],[1,"promo-form",3,"ngSubmit","formGroup"],["appearance","outline",1,"promo-input",3,"color"],["matInput","","formControlName","code","placeholder","Es. SUMMER25"],["matSuffix","",4,"ngIf"],["mat-flat-button","","color","primary","type","submit",3,"disabled"],["class","promo-status",3,"ngClass",4,"ngIf"],[1,"referral-card"],[1,"referral-icon"],[1,"referral-code-box"],[1,"referral-code"],["mat-icon-button","","matTooltip","Copia codice",3,"click"],["class","copy-message",4,"ngIf"],[1,"referral-progress"],["mode","determinate",3,"value"],[1,"referral-bonus-list"],["color","accent","selected","",4,"ngFor","ngForOf"],["matSuffix",""],[1,"promo-status",3,"ngClass"],[1,"copy-message"],["color","accent","selected",""]],template:function(t,r){t&1&&(i(0,"section",0)(1,"mat-card",1)(2,"mat-card-header")(3,"mat-icon",2),o(4,"redeem"),e(),i(5,"mat-card-title"),o(6,"Codici Promo"),e()(),i(7,"mat-card-content")(8,"p"),o(9,"Inserisci un codice per ottenere sconti esclusivi."),e(),i(10,"form",3),f("ngSubmit",function(){return r.applyPromo()}),i(11,"mat-form-field",4)(12,"mat-label"),o(13,"Codice promo"),e(),g(14,"input",5),p(15,_i,2,1,"mat-icon",6),e(),i(16,"button",7),o(17,"Applica"),e()(),p(18,vi,2,2,"p",8),e()(),i(19,"mat-card",9)(20,"mat-card-header")(21,"mat-icon",10),o(22,"group_add"),e(),i(23,"mat-card-title"),o(24,"Programma Referral"),e()(),i(25,"mat-card-content")(26,"p"),o(27,"Condividi il tuo codice con un amico e ricevi un premio!"),e(),i(28,"div",11)(29,"span",12),o(30),e(),i(31,"button",13),f("click",function(){return r.copyReferralCode()}),i(32,"mat-icon"),o(33,"content_copy"),e()()(),p(34,Ci,2,1,"p",14),i(35,"div",15)(36,"p")(37,"strong"),o(38,"Inviti completati:"),e(),o(39),e(),g(40,"mat-progress-bar",16),e(),i(41,"div",17)(42,"div"),p(43,xi,2,1,"mat-chip",18),e()()()()()),t&2&&(l(10),c("formGroup",r.promoForm),l(),c("color",r.promoStatusColor),l(4),c("ngIf",r.promoStatusIcon),l(),c("disabled",r.promoForm.invalid),l(2),c("ngIf",r.promoStatus),l(12),u(r.userReferralCode),l(4),c("ngIf",r.copyMessage),l(5),C(" ",r.completedReferrals.length,""),l(),c("value",r.completedReferrals.length*10),l(3),c("ngForOf",r.completedReferrals))},dependencies:[w,Qt,F,B,I,q,k,K,U,H,G,X,j,gt,ft,tt,Me,et,z,$,R,T,D,N,A],styles:[".promo-referral-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:24px;padding:24px}mat-card[_ngcontent-%COMP%]{border-radius:12px;box-shadow:0 2px 8px #00000014}.promo-icon[_ngcontent-%COMP%], .referral-icon[_ngcontent-%COMP%]{font-size:28px;color:#fdd835;margin-right:8px}.promo-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.promo-input[_ngcontent-%COMP%]{width:100%}.promo-status[_ngcontent-%COMP%]{font-weight:600;margin-top:8px}.promo-status.primary[_ngcontent-%COMP%]{color:#2e7d32}.promo-status.warn[_ngcontent-%COMP%]{color:#c62828}.referral-code-box[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;background:#eee;padding:8px 12px;border-radius:6px;margin:12px 0;font-weight:600;font-size:16px}.copy-message[_ngcontent-%COMP%]{font-size:13px;color:#43a047;margin-bottom:12px}.referral-progress[_ngcontent-%COMP%]{margin:12px 0}.referral-progress[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:4px;font-size:14px;font-weight:500}.referral-bonus-list[_ngcontent-%COMP%]{margin-top:8px}.referral-bonus-list[_ngcontent-%COMP%]   mat-chip[_ngcontent-%COMP%]{font-weight:600;font-size:14px;padding:6px}"]})};var hi=[{path:"",component:bt},{path:"booking-history",component:It},{path:"buoni",component:Bt},{path:"reviews",component:Et},{path:"settings",component:Ft}],Rt=class a{static \u0275fac=function(t){return new(t||a)};static \u0275mod=ct({type:a});static \u0275inj=mt({imports:[Nt.forChild(hi),Nt]})};var Oe=class a{static \u0275fac=function(t){return new(t||a)};static \u0275mod=ct({type:a});static \u0275inj=mt({imports:[w,Rt]})};export{Oe as ClientsModule};
